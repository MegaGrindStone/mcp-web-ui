{{define "chat_message"}}
<div class="message mb-3 {{if eq .Role "user"}}text-end{{end}}">
    <div class="d-flex {{if eq .Role "user"}}justify-content-end{{end}} align-items-start gap-2">
        {{if ne .Role "user"}}
        <div class="avatar">
            <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                <small class="text-white">AI</small>
            </div>
        </div>
        {{end}}
        
        <div class="message-content">
            <div class="message-bubble p-3 rounded-3 {{if eq .Role "user"}}bg-primary text-white{{else}}bg-light{{end}}">
                <p class="mb-0">{{.Content}}</p>
            </div>
            <div class="message-meta mt-1">
                <small class="text-muted">{{.Timestamp.Format "15:04"}}</small>
            </div>
        </div>

        {{if eq .Role "user"}}
        <div class="avatar">
            <div class="rounded-circle bg-info d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                <small class="text-white">You</small>
            </div>
        </div>
        {{end}}
    </div>
</div>
{{end}}
